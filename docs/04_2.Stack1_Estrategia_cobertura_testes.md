<<**Arquivo gerado manualmente**>>

---

[3 tools called]


A estratégia de cobertura de testes combina dois níveis (unitário e integração) e segue uma organização clara dos cenários.

---

## Estratégia de cobertura de testes

### 1. Pirâmide de testes (dois níveis)

| Nível            | Tipo        | Escopo                        | Ferramenta    | Estado        |
|------------------|------------|-------------------------------|---------------|---------------|
| **Unitário**     | Testes de unidade | Camada de aplicação (Services) | Jest + mocks  | Implementado  |
| **Integração**   | Testes de integração | API REST completa (vários módulos) | Jest + supertest | Proposto      |

A base da pirâmide é unitária; no topo, testes de integração cobrem o fluxo completo via API.

---

### 2. Cobertura unitária (QuartoService)

**Abordagem**: testar a lógica de negócio isolada, mockando `IQuartoRepository`.

**Organização por operação**:
- **`cadastrar`** – 7 cenários
- **`editar`** – 7 cenários

**Classes de cenário**:

| Categoria     | Exemplos |
|---------------|----------|
| Caminho feliz | Sucesso com dados válidos, valores padrão (ex.: status LIVRE) |
| Validação     | Número vazio, tipo ausente, capacidade inválida, preço negativo |
| Regras de negócio | Número duplicado (ConflictError), quarto inexistente (NotFoundError) |
| Casos de borda | ID obrigatório na edição, manter mesmo número ao editar |

**Rastreamento de requisitos**:
- RF-04.5 (unicidade do número) → conflito em cadastro e edição
- RF-01.1 / RF-01.4 → validações de formato (número, tipo, capacidade, preço)

---

### 3. Cobertura de integração (proposta)

**Abordagem**: exercitar todo o fluxo **Hóspede → Reserva → Quarto** via HTTP, sem mocks nas rotas.

**Categorias de cenários** (10 casos):

| Categoria       | Quantidade | Objetivo |
|-----------------|------------|----------|
| Fluxo feliz     | 1 (IT-01)  | Garantir que o fluxo completo funciona de ponta a ponta |
| Regras RF-04    | 3 (IT-02–04) | Cobrir RF-04.1 e RF-04.2 (disponibilidade e bloqueios) |
| Validações/erros| 4 (IT-05–08) | Quarto/hóspede inexistentes, dados inválidos, datas incorretas |
| Consistência    | 2 (IT-09–10) | Integridade entre módulos e isolamento entre reservas |

**Cobertura horizontal**:
- API REST (Controllers e rotas)
- Services (Quarto, Hospede, Reserva)
- Repositórios em memória (dados compartilhados)
- Fluxo transacional entre os três módulos

---

### 4. Critérios de cobertura por tipo de teste

| Aspecto             | Unitário                          | Integração                  |
|---------------------|-----------------------------------|-----------------------------|
| **Granularidade**   | Método/operação                   | Cenário de negócio completo |
| **Dependências**    | Mockadas (Repository)             | Reais (em memória)          |
| **Entrada**         | DTOs e entidades                  | HTTP (JSON)                 |
| **Saída**           | Entidades e exceções              | Status HTTP e corpo JSON    |
| **Foco**            | Regras isoladas                   | Fluxos e integração entre módulos |

---

### 5. Configuração Jest

`collectCoverageFrom` em `jest.config.js`:
- Inclui: `src/**/*.ts`
- Exclui: `*.d.ts` (declarações)
- Não há meta de percentual definida (thresholds)

---

### 6. Visão geral da estratégia

1. **Unitário primeiro**: regras críticas de QuartoService cobertas com mocks e asserções claras.
2. **Integração depois**: o fluxo Reserva/Hóspede/Quarto é validado via API, garantindo que os módulos funcionem em conjunto.
3. **Categorização**: fluxo feliz, regras RF-04, validações e consistência.
4. **Rastreabilidade**: cada cenário está ligado a requisitos funcionais (RF-02, RF-03, RF-04).
5. **Sem redundância desnecessária**: unitários cobrem lógica interna; integração cobre fluxos e contratos da API.