<<**Arquivo gerado manualmente**>>

---

## Como a refatoração reduz dívida técnica

A dívida técnica é o custo futuro de manter e evoluir o código. As mudanças feitas diminuem esse custo de várias formas:

---

### 1. **Tratamento consistente de erros**

**Antes:** `obterPorId` e `alterarStatus` retornavam `null`; `editar` lançava `NotFoundError`. O consumidor precisava tratar dois padrões.  

**Depois:** Todos lançam `NotFoundError` quando o recurso não existe.

**Redução de dívida:**  
- Um único padrão: “não encontrado” sempre via exceção.  
- Menos condicionais (`if (!quarto)`) no Controller.  
- Menos risco de esquecer a checagem de `null` em novos fluxos.  
- Mais fácil de mudar o tratamento de erro em um só lugar (`handleDomainError`).

---

### 2. **Remoção de non-null assertion (`dto.id!`)**

**Antes:** Uso de `dto.id!` assumindo que o `Validator` sempre garantia o `id`.  

**Depois:** Checagem explícita `if (id == null)` e lançamento de `ValidationError`.

**Redução de dívida:**  
- Evita que mudanças no `Validator` quebrem o código silenciosamente.  
- O TypeScript consegue inferir o tipo após a validação, sem `!`.  
- A intenção fica explícita: “quem chama editar precisa passar id, senão é erro”.

---

### 3. **Remoção de redundância**

**Antes:** `cadastrar` fazia `{ ...dto, status: dto.status ?? StatusQuarto.LIVRE }` mesmo com o `Mapper` já aplicando esse default.  

**Depois:** `cadastrar` passa `dto` diretamente para o Mapper.

**Redução de dívida:**  
- Uma única fonte de verdade para o default de `status`.  
- Menos duplicação e menos risco de divergência se a regra mudar.  
- Código mais simples e fácil de manter.

---

### 4. **Assinaturas mais previsíveis**

**Antes:** `obterPorId` e `alterarStatus` retornavam `Quarto | null`, exigindo checagem em todo lugar.  

**Depois:** Retornam `Quarto`; “não encontrado” vira exceção.

**Redução de dívida:**  
- Menos branches e condições espalhadas.  
- O contrato dos métodos fica claro: “o retorno é sempre um quarto válido”.  
- Menos risco de não tratar `null` e causar `TypeError`.

---

### 5. **Controller mais simples**

**Antes:** Verificações manuais de `null` e envio de 404 em vários pontos.  

**Depois:** O fluxo normal segue até o retorno; erros são tratados em `handleDomainError`.

**Redução de dívida:**  
- Menos repetição de lógica de erro no Controller.  
- Fluxo principal mais linear e legível.  
- Mudanças no tratamento de erros concentradas em um único handler.

---

### Resumo do impacto

| Aspecto | Efeito na dívida técnica |
|--------|---------------------------|
| **Consistência** | Um padrão para erros → menos confusão e menos bugs |
| **Confiança no tipo** | Menos `!` e checagens implícitas → TypeScript mais útil |
| **DRY** | Sem duplicação de regras → menos pontos para atualizar |
| **Contratos** | Métodos retornam só o que prometem → menos acoplamento |
| **Manutenibilidade** | Código mais simples → menor custo para futuras mudanças |

O resultado é um código mais previsível, fácil de testar e de evoluir sem gerar novos ajustes em vários pontos.